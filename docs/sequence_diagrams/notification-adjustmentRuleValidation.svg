<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="957.6px" preserveAspectRatio="none" style="width:656px;height:957px;" version="1.1" viewBox="0 0 656 957" width="656px" zoomAndPan="magnify"><defs><filter height="300%" id="f1f2t1k7hzubg5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.600000023841858"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="3.200000047683716" dy="3.200000047683716" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="11.2" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="304" x="177" y="18.8281">10.3. Notification Limit Adjustment Rules Validation</text><rect fill="#FFFFE0" height="921.4594" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="124" x="18.4" y="27.5906"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="37.2" y="37.6453">Central Services</text><rect fill="#90EE90" height="921.4594" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="416" x="210.8" y="27.5906"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="176" x="330.8" y="37.6453">Central Event Processing Service</text><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="76.4" y="193.4719"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="782.0297" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="277.2" y="101.0297"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="362.4109"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="435.9563"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="698.4047"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="803.3984"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="776.4297" style="stroke: #000000; stroke-width: 1.600000023841858;" width="638" x="9.6" y="106.6297"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="545.9453" style="stroke: #000000; stroke-width: 1.600000023841858;" width="516.4" x="123.2" y="331.5141"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="272.0484" style="stroke: #000000; stroke-width: 1.600000023841858;" width="425.6" x="206" y="587.8469"/><rect fill="#FFFFFF" height="224.3516" style="stroke: none; stroke-width: 0.800000011920929;" width="425.6" x="206" y="635.5438"/><rect fill="#FFFFFF" height="11.9641" style="stroke: none; stroke-width: 0.800000011920929;" width="516.4" x="123.2" y="865.4953"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 5.0,5.0;" x1="80" x2="80" y1="93.0297" y2="896.6594"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 5.0,5.0;" x1="281.2" x2="281.2" y1="93.0297" y2="896.6594"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 5.0,5.0;" x1="594.8" x2="594.8" y1="93.0297" y2="896.6594"/><rect fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="24.8" y="61.4391"/><rect fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="21.6" y="64.6391"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="100" x="27.2" y="81.0672">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="24.8" y="895.8594"/><rect fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="21.6" y="899.0594"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="100" x="27.2" y="915.4875">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="129.6" x="214" y="90.6672">Central Event Processor</text><path d="M264.8,57.4391 L264.8,76.6391 M264.8,67.0391 L278.4,67.0391 " fill="none" filter="url(#f1f2t1k7hzubg5)" style="stroke: #A80036; stroke-width: 1.600000023841858;"/><ellipse cx="288" cy="67.0391" fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 1.600000023841858;"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="129.6" x="214" y="906.6875">Central Event Processor</text><path d="M264.8,912.25 L264.8,931.45 M264.8,921.85 L278.4,921.85 " fill="none" filter="url(#f1f2t1k7hzubg5)" style="stroke: #A80036; stroke-width: 1.600000023841858;"/><ellipse cx="288" cy="921.85" fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 1.600000023841858;"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="566" y="90.6672">CEP Store</text><path d="M580.4,51.0391 C580.4,43.0391 594.8,43.0391 594.8,43.0391 C594.8,43.0391 609.2,43.0391 609.2,51.0391 L609.2,71.8391 C609.2,79.8391 594.8,79.8391 594.8,79.8391 C594.8,79.8391 580.4,79.8391 580.4,71.8391 L580.4,51.0391 " fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><path d="M580.4,51.0391 C580.4,59.0391 594.8,59.0391 594.8,59.0391 C594.8,59.0391 609.2,59.0391 609.2,51.0391 " fill="none" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="566" y="906.6875">CEP Store</text><path d="M580.4,917.05 C580.4,909.05 594.8,909.05 594.8,909.05 C594.8,909.05 609.2,909.05 609.2,917.05 L609.2,937.85 C609.2,945.85 594.8,945.85 594.8,945.85 C594.8,945.85 580.4,945.85 580.4,937.85 L580.4,917.05 " fill="#FEFECE" filter="url(#f1f2t1k7hzubg5)" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><path d="M580.4,917.05 C580.4,925.05 594.8,925.05 594.8,925.05 C594.8,925.05 609.2,925.05 609.2,917.05 " fill="none" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="76.4" y="193.4719"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="782.0297" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="277.2" y="101.0297"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="362.4109"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="435.9563"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="698.4047"/><rect fill="#FFFFFF" filter="url(#f1f2t1k7hzubg5)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="590.8" y="803.3984"/><path d="M9.6,106.6297 L229.6,106.6297 L229.6,112.2297 L221.6,120.2297 L9.6,120.2297 L9.6,106.6297 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.800000011920929;"/><rect fill="none" height="776.4297" style="stroke: #000000; stroke-width: 1.600000023841858;" width="638" x="9.6" y="106.6297"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="184" x="21.6" y="117.4844">Limit Adjustment Rules Validation</text><path d="M17.6,124.4781 L17.6,168.4781 L139.2,168.4781 L139.2,132.4781 L131.2,124.4781 L17.6,124.4781 " fill="#FBFB77" filter="url(#f1f2t1k7hzubg5)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M131.2,124.4781 L131.2,132.4781 L139.2,132.4781 L131.2,124.4781 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="104" x="22.4" y="138.5328">Events are published</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="104.8" x="22.4" y="150.7813">to Notification Topic</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="95.2" x="22.4" y="163.0297">by Central Services</text><polygon fill="#A80036" points="93.2,190.2719,85.2,193.4719,93.2,196.6719,90,193.4719" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="88.4" x2="276.4" y1="193.4719" y2="193.4719"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="98" y="189.6781">1</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="167.2" x="108.4" y="189.6781">Consumes notification messages</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="318.8" y1="240.9203" y2="240.9203"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="318.8" x2="318.8" y1="240.9203" y2="251.3203"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="286" x2="318.8" y1="251.3203" y2="251.3203"/><polygon fill="#A80036" points="294,248.1203,286,251.3203,294,254.5203,290.8,251.3203" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="290.8" y="237.1266">2</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="156.8" x="301.2" y="237.1266">Filter according to event action</text><path d="M180,261.7203 L180,318.5203 L379.2,318.5203 L379.2,269.7203 L371.2,261.7203 L180,261.7203 " fill="#FBFB77" filter="url(#f1f2t1k7hzubg5)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M371.2,261.7203 L371.2,269.7203 L379.2,269.7203 L371.2,261.7203 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="116.8" x="184.8" y="275.775">Qualifying event action</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="184.8" y="288.0234">{</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="182.4" x="184.8" y="300.2719">"limit" in data.value.content.payload</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="184.8" y="312.5203">}</text><path d="M123.2,331.5141 L172.8,331.5141 L172.8,337.1141 L164.8,345.1141 L123.2,345.1141 L123.2,331.5141 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.800000011920929;"/><rect fill="none" height="545.9453" style="stroke: #000000; stroke-width: 1.600000023841858;" width="516.4" x="123.2" y="331.5141"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13.6" x="135.2" y="342.3688">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="184.8" y="341.6219">[Messages event type that qualify]</text><polygon fill="#A80036" points="581.2,359.2109,589.2,362.4109,581.2,365.6109,584.4,362.4109" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="586" y1="362.4109" y2="362.4109"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="290.8" y="358.6172">3</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="106.4" x="301.2" y="358.6172">Update current limits</text><polygon fill="#FFFFE0" filter="url(#f1f2t1k7hzubg5)" points="578.4,372.8109,610.4,372.8109,618.4,381.6109,610.4,391.2109,578.4,391.2109,570.4,381.6109,578.4,372.8109" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="580" y="386.0656">limits</text><polygon fill="#A80036" points="294,409.3078,286,412.5078,294,415.7078,290.8,412.5078" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="289.2" x2="594" y1="412.5078" y2="412.5078"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="298.8" y="408.7141">4</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="70.4" x="309.2" y="408.7141">Return results</text><polygon fill="#A80036" points="581.2,432.7563,589.2,435.9563,581.2,439.1563,584.4,435.9563" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="586" y1="435.9563" y2="435.9563"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="290.8" y="432.1625">5</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="144.8" x="301.2" y="432.1625">Create events per participant</text><polygon fill="#FFFFE0" filter="url(#f1f2t1k7hzubg5)" points="576.8,446.3563,612.8,446.3563,620.8,455.1563,612.8,464.7563,576.8,464.7563,568.8,455.1563,576.8,446.3563" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="32.8" x="578.4" y="459.6109">events</text><polygon fill="#A80036" points="294,482.8531,286,486.0531,294,489.2531,290.8,486.0531" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="289.2" x2="594" y1="486.0531" y2="486.0531"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="298.8" y="482.2594">6</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="70.4" x="309.2" y="482.2594">Return results</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="318.8" y1="509.5016" y2="509.5016"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="318.8" x2="318.8" y1="509.5016" y2="519.9016"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="286" x2="318.8" y1="519.9016" y2="519.9016"/><polygon fill="#A80036" points="294,516.7016,286,519.9016,294,523.1016,290.8,519.9016" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="290.8" y="505.7078">7</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="142.4" x="301.2" y="505.7078">Check if their is a difference</text><path d="M131.2,530.3016 L131.2,574.3016 L428,574.3016 L428,538.3016 L420,530.3016 L131.2,530.3016 " fill="#FBFB77" filter="url(#f1f2t1k7hzubg5)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M420,530.3016 L420,538.3016 L428,538.3016 L420,530.3016 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="189.6" x="136" y="544.3563">Check if there is a difference between</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="280" x="136" y="556.6047">the stored and captured limits for both payee and payer</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="84.8" x="136" y="568.8531">for all currencies</text><path d="M206,587.8469 L255.6,587.8469 L255.6,593.4469 L247.6,601.4469 L206,601.4469 L206,587.8469 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.800000011920929;"/><rect fill="none" height="272.0484" style="stroke: #000000; stroke-width: 1.600000023841858;" width="425.6" x="206" y="587.8469"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13.6" x="218" y="598.7016">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124.8" x="267.6" y="597.9547">[Limit difference identified]</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="318.8" y1="618.7438" y2="618.7438"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="318.8" x2="318.8" y1="618.7438" y2="629.1438"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="286" x2="318.8" y1="629.1438" y2="629.1438"/><polygon fill="#A80036" points="294,625.9438,286,629.1438,294,632.3438,290.8,629.1438" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="290.8" y="614.95">8</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="284" x="301.2" y="614.95">Create new action object and pass it to the Action Agent</text><line style="stroke: #000000; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="206" x2="631.6" y1="636.3438" y2="636.3438"/><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140.8" x="210" y="644.8516">[Limits are equal - same event]</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="318.8" y1="664.5563" y2="664.5563"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="318.8" x2="318.8" y1="664.5563" y2="674.9563"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="286" x2="318.8" y1="674.9563" y2="674.9563"/><polygon fill="#A80036" points="294,671.7563,286,674.9563,294,678.1563,290.8,674.9563" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="290.8" y="660.7625">9</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="175.2" x="301.2" y="660.7625">Send finish single to Action Agent.</text><polygon fill="#A80036" points="581.2,695.2047,589.2,698.4047,581.2,701.6047,584.4,698.4047" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="285.2" x2="586" y1="698.4047" y2="698.4047"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14.4" x="290.8" y="694.6109">10</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="132" x="308.4" y="694.6109">Request action from event</text><polygon fill="#FFFFE0" filter="url(#f1f2t1k7hzubg5)" points="574.4,708.8047,614.4,708.8047,622.4,717.6047,614.4,727.2047,574.4,727.2047,566.4,717.6047,574.4,708.8047" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="36.8" x="576" y="722.0594">actions</text><polygon fill="#A80036" points="294,745.3016,286,748.5016,294,751.7016,290.8,748.5016" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="289.2" x2="594" y1="748.5016" y2="748.5016"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14.4" x="298.8" y="744.7078">11</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="70.4" x="316.4" y="744.7078">Return results</text><path d="M288.8,758.9016 L288.8,778.9016 L425.6,778.9016 L425.6,766.9016 L417.6,758.9016 L288.8,758.9016 " fill="#FBFB77" filter="url(#f1f2t1k7hzubg5)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M417.6,758.9016 L417.6,766.9016 L425.6,766.9016 L417.6,758.9016 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="120" x="293.6" y="772.9563">deactive pending action</text><polygon fill="#A80036" points="581.2,800.1984,589.2,803.3984,581.2,806.5984,584.4,803.3984" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="285.2" x2="586" y1="803.3984" y2="803.3984"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14.4" x="290.8" y="799.6047">12</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="176" x="308.4" y="799.6047">Persist updated action to CEP Store</text><polygon fill="#FFFFE0" filter="url(#f1f2t1k7hzubg5)" points="574.4,813.7984,614.4,813.7984,622.4,822.5984,614.4,832.1984,574.4,832.1984,566.4,822.5984,574.4,813.7984" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="36.8" x="576" y="827.0531">actions</text><polygon fill="#A80036" points="294,850.2953,286,853.4953,294,856.6953,290.8,853.4953" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="289.2" x2="594" y1="853.4953" y2="853.4953"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14.4" x="298.8" y="849.7016">13</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="70.4" x="316.4" y="849.7016">Return results</text><line style="stroke: #000000; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="123.2" x2="639.6" y1="866.2953" y2="866.2953"/><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="263.2" x="127.2" y="874.8031">[Ignore - Message does not qualify for notification action]</text><!--
@startuml
title 10.3. Notification Limit Adjustment Rules Validation
autonumber

collections "Notification-Topic" as TOPIC_NOTIFY
boundary "Central Event Processor" as CEP
database "CEP Store" as DB

box "Central Services" #LightYellow
participant TOPIC_NOTIFY
end box
box "Central Event Processing Service" #LightGreen
participant CEP
participant DB
end box

Group Limit Adjustment Rules Validation
    activate CEP
    note over TOPIC_NOTIFY
        Events are published
        to Notification Topic
        by Central Services
    end note
    TOPIC_NOTIFY <- - CEP: Consumes notification messages
    activate TOPIC_NOTIFY
    deactivate TOPIC_NOTIFY
    CEP -> CEP: Filter according to event action
    note over CEP
        Qualifying event action
        {
        "limit" in data.value.content.payload
        }
    end note

    alt Messages event type that qualify
        CEP -> DB: Update current limits
        activate DB
        hnote over DB #LightYellow
        limits
        end hnote
        CEP <- - DB: Return results
        deactivate DB
        CEP -> DB: Create events per participant
        activate DB
        hnote over DB #LightYellow
        events
        end hnote
        CEP <- - DB: Return results
        deactivate DB
        CEP -> CEP: Check if their is a difference
        note over of CEP
            Check if there is a difference between
            the stored and captured limits for both payee and payer
            for all currencies
        end note

        alt Limit difference identified
            CEP -> CEP: Create new action object and pass it to the Action Agent
        else Limits are equal - same event
            CEP -> CEP: Send finish single to Action Agent.
            CEP -> DB: Request action from event
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
            CEP <- - DB: Return results
            deactivate DB
            note right of CEP
                deactive pending action
            end note
            CEP - -> DB: Persist updated action to CEP Store
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
            CEP <- - DB: Return results
            deactivate DB
        end
    else Ignore - Message does not qualify for notification action
    end
    deactivate CEP
end
@enduml

PlantUML version 1.2018.11(Sat Sep 22 18:43:53 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Mac OS X
OS Version: 10.14.2
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>