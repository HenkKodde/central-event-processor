<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1430px" preserveAspectRatio="none" style="width:747px;height:1430px;" version="1.1" viewBox="0 0 747 1430" width="747px" zoomAndPan="magnify"><defs><filter height="300%" id="f1kh3sl0ungvo9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="380" x="184.75" y="23.5352">10.2. Notification Limit Adjustment Rules Validation</text><rect fill="#FFFFE0" height="1384.998" style="stroke: #A80036; stroke-width: 1.0;" width="155" x="19" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="42.5" y="47.0566">Central Services</text><rect fill="#90EE90" height="1384.998" style="stroke: #A80036; stroke-width: 1.0;" width="451" x="259.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="220" x="375" y="47.0566">Central Event Processing Service</text><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="91.5" y="241.8398"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="1210.7109" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="342.5" y="126.2871"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="468.3242"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="560.9453"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="1105.4902"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="1236.7324"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="1203.7109" style="stroke: #000000; stroke-width: 2.0;" width="723.5" x="13" y="133.2871"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="900.2949" style="stroke: #000000; stroke-width: 2.0;" width="483" x="243.5" y="429.7031"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="541.2344" style="stroke: #000000; stroke-width: 2.0;" width="463" x="253.5" y="766.8086"/><rect fill="#FFFFFF" height="381.3711" style="stroke: none; stroke-width: 1.0;" width="463" x="253.5" y="926.6719"/><rect fill="#FFFFFF" height="14.9551" style="stroke: none; stroke-width: 1.0;" width="483" x="243.5" y="1315.043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="96" x2="96" y1="116.2871" y2="1353.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="347.5" x2="347.5" y1="116.2871" y2="1353.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="670.5" x2="670.5" y1="116.2871" y2="1353.998"/><rect fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="27" y="76.7988"/><rect fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="23" y="80.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="30" y="101.334">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="27" y="1352.998"/><rect fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="23" y="1356.998"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="30" y="1377.5332">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="263.5" y="113.334">Central Event Processor</text><ellipse cx="347.5" cy="83.7988" fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="343.5,71.7988,349.5,66.7988,347.5,71.7988,349.5,76.7988,343.5,71.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="263.5" y="1366.5332">Central Event Processor</text><ellipse cx="347.5" cy="1385.4863" fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="343.5,1373.4863,349.5,1368.4863,347.5,1373.4863,349.5,1378.4863,343.5,1373.4863" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="634.5" y="113.334">CEP Store</text><path d="M652.5,63.7988 C652.5,53.7988 670.5,53.7988 670.5,53.7988 C670.5,53.7988 688.5,53.7988 688.5,63.7988 L688.5,89.7988 C688.5,99.7988 670.5,99.7988 670.5,99.7988 C670.5,99.7988 652.5,99.7988 652.5,89.7988 L652.5,63.7988 " fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M652.5,63.7988 C652.5,73.7988 670.5,73.7988 670.5,73.7988 C670.5,73.7988 688.5,73.7988 688.5,63.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="634.5" y="1366.5332">CEP Store</text><path d="M652.5,1379.4863 C652.5,1369.4863 670.5,1369.4863 670.5,1369.4863 C670.5,1369.4863 688.5,1369.4863 688.5,1379.4863 L688.5,1405.4863 C688.5,1415.4863 670.5,1415.4863 670.5,1415.4863 C670.5,1415.4863 652.5,1415.4863 652.5,1405.4863 L652.5,1379.4863 " fill="#FEFECE" filter="url(#f1kh3sl0ungvo9)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M652.5,1379.4863 C652.5,1389.4863 670.5,1389.4863 670.5,1389.4863 C670.5,1389.4863 688.5,1389.4863 688.5,1379.4863 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="91.5" y="241.8398"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="1210.7109" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="342.5" y="126.2871"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="468.3242"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="560.9453"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="62.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="1105.4902"/><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="1236.7324"/><path d="M13,133.2871 L288,133.2871 L288,140.2871 L278,150.2871 L13,150.2871 L13,133.2871 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1203.7109" style="stroke: #000000; stroke-width: 2.0;" width="723.5" x="13" y="133.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="230" x="28" y="146.8555">Limit Adjustment Rules Validation</text><path d="M101,155.5977 L101,210.5977 L253,210.5977 L253,165.5977 L243,155.5977 L101,155.5977 " fill="#D3D3D3" filter="url(#f1kh3sl0ungvo9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M243,155.5977 L243,165.5977 L253,165.5977 L243,155.5977 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="107" y="173.166">Events are published</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="107" y="188.4766">to Notification Topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="107" y="203.7871">by Central Services</text><polygon fill="#A80036" points="112.5,237.8398,102.5,241.8398,112.5,245.8398,108.5,241.8398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="106.5" x2="341.5" y1="241.8398" y2="241.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="118.5" y="237.0977">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="131.5" y="237.0977">Consumes notification messages</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="394.5" y1="301.1504" y2="301.1504"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="394.5" y1="301.1504" y2="314.1504"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="394.5" y1="314.1504" y2="314.1504"/><polygon fill="#A80036" points="363.5,310.1504,353.5,314.1504,363.5,318.1504,359.5,314.1504" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="296.4082">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="372.5" y="296.4082">Filter according to event action</text><path d="M357,327.1504 L357,413.1504 L622,413.1504 L622,337.1504 L612,327.1504 L357,327.1504 " fill="#FBFB77" filter="url(#f1kh3sl0ungvo9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M612,327.1504 L612,337.1504 L622,337.1504 L612,327.1504 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="363" y="344.7188">Qualifying event action:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="367" y="360.0293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="363" y="375.3398">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="379" y="390.6504">"limit" in data.value.content.payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="363" y="405.9609">}</text><path d="M243.5,429.7031 L305.5,429.7031 L305.5,436.7031 L295.5,446.7031 L243.5,446.7031 L243.5,429.7031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="900.2949" style="stroke: #000000; stroke-width: 2.0;" width="483" x="243.5" y="429.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="258.5" y="443.2715">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="320.5" y="442.3379">[Messages event type that qualify]</text><polygon fill="#A80036" points="653.5,464.3242,663.5,468.3242,653.5,472.3242,657.5,468.3242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="659.5" y1="468.3242" y2="468.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="463.582">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="372.5" y="463.582">Update current</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="469.5" y="463.582">limits</text><polygon fill="#FFFFE0" filter="url(#f1kh3sl0ungvo9)" points="650,511.3242,690,511.3242,700,522.3242,690,534.3242,650,534.3242,640,522.3242,650,511.3242" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="652" y="527.8926">limits</text><polygon fill="#A80036" points="653.5,556.9453,663.5,560.9453,653.5,564.9453,657.5,560.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="659.5" y1="560.9453" y2="560.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="556.2031">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="372.5" y="556.2031">Create</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="416.5" y="556.2031">events</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="465.5" y="556.2031">per participant</text><polygon fill="#FFFFE0" filter="url(#f1kh3sl0ungvo9)" points="648,603.9453,693,603.9453,703,614.9453,693,626.9453,648,626.9453,638,614.9453,648,603.9453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="650" y="620.5137">events</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="394.5" y1="653.5664" y2="653.5664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="394.5" y1="653.5664" y2="666.5664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="394.5" y1="666.5664" y2="666.5664"/><polygon fill="#A80036" points="363.5,662.5664,353.5,666.5664,363.5,670.5664,359.5,666.5664" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="648.8242">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="376.5" y="648.8242"/><path d="M357,679.5664 L357,750.5664 L625,750.5664 L625,689.5664 L615,679.5664 L357,679.5664 " fill="#D3D3D3" filter="url(#f1kh3sl0ungvo9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M615,679.5664 L615,689.5664 L625,689.5664 L615,679.5664 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="363" y="697.1348">Check if there is a difference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="363" y="712.4453">between the stored and captured</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="573" y="712.4453">limits</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="363" y="727.7559">for both</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="418" y="727.7559">payee</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="463" y="727.7559">and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="490" y="727.7559">payer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="363" y="743.0664">for all</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="404" y="743.0664">currencies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="475" y="743.0664">.</text><path d="M253.5,766.8086 L315.5,766.8086 L315.5,773.8086 L305.5,783.8086 L253.5,783.8086 L253.5,766.8086 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="541.2344" style="stroke: #000000; stroke-width: 2.0;" width="463" x="253.5" y="766.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="268.5" y="780.377">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="156" x="330.5" y="779.4434">[Limit difference identified]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="394.5" y1="805.4297" y2="805.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="394.5" y1="805.4297" y2="818.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="394.5" y1="818.4297" y2="818.4297"/><polygon fill="#A80036" points="363.5,814.4297,353.5,818.4297,363.5,822.4297,359.5,818.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="800.6875">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="376.5" y="800.6875"/><path d="M357,831.4297 L357,856.4297 L546,856.4297 L546,841.4297 L536,831.4297 L357,831.4297 " fill="#D3D3D3" filter="url(#f1kh3sl0ungvo9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M536,831.4297 L536,841.4297 L546,841.4297 L536,831.4297 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="363" y="848.998">Create new</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="436" y="848.998">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="527" y="848.998">.</text><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="287" x="260.5" y="865.7402"/><polygon fill="#EEEEEE" points="260.5,865.7402,324.5,865.7402,324.5,872.7402,314.5,882.7402,260.5,882.7402,260.5,865.7402" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="273.5" y="880.3086">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="266.5" y="899.3086">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="110" x="427.5" y="899.3086">10.4-action-flow</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="427.5" x2="537.5" y1="901.3086" y2="901.3086"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="537.5" y="899.3086">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="270.5" y="914.6191"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="253.5" x2="716.5" y1="927.6719" y2="927.6719"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="176" x="258.5" y="938.3066">[Limits are equal - same event]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="394.5" y1="962.9375" y2="962.9375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="394.5" y1="962.9375" y2="975.9375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="353.5" x2="394.5" y1="975.9375" y2="975.9375"/><polygon fill="#A80036" points="363.5,971.9375,353.5,975.9375,363.5,979.9375,359.5,975.9375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="958.1953">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="376.5" y="958.1953"/><path d="M357,988.9375 L357,1013.9375 L605,1013.9375 L605,998.9375 L595,988.9375 L357,988.9375 " fill="#D3D3D3" filter="url(#f1kh3sl0ungvo9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M595,988.9375 L595,998.9375 L605,998.9375 L595,988.9375 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="363" y="1006.5059">Send Action Object to Action Agent.</text><rect fill="#FFFFFF" filter="url(#f1kh3sl0ungvo9)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="287" x="260.5" y="1023.248"/><polygon fill="#EEEEEE" points="260.5,1023.248,324.5,1023.248,324.5,1030.248,314.5,1040.248,260.5,1040.248,260.5,1023.248" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="273.5" y="1037.8164">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="266.5" y="1056.8164">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="110" x="427.5" y="1056.8164">10.4-action-flow</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="427.5" x2="537.5" y1="1058.8164" y2="1058.8164"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="537.5" y="1056.8164">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="270.5" y="1072.127"/><polygon fill="#A80036" points="653.5,1101.4902,663.5,1105.4902,653.5,1109.4902,657.5,1105.4902" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="659.5" y1="1105.4902" y2="1105.4902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="359.5" y="1100.748">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="372.5" y="1100.748">Request</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="426.5" y="1100.748">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="521.5" y="1100.748">for event</text><polygon fill="#FFFFE0" filter="url(#f1kh3sl0ungvo9)" points="645,1118.4902,695,1118.4902,705,1129.4902,695,1141.4902,645,1141.4902,635,1129.4902,645,1118.4902" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="647" y="1135.0586">actions</text><polygon fill="#A80036" points="363.5,1164.1113,353.5,1168.1113,363.5,1172.1113,359.5,1168.1113" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="357.5" x2="669.5" y1="1168.1113" y2="1168.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="1163.3691">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="382.5" y="1163.3691">Return results</text><path d="M357,1181.1113 L357,1206.1113 L620,1206.1113 L620,1191.1113 L610,1181.1113 L357,1181.1113 " fill="#D3D3D3" filter="url(#f1kh3sl0ungvo9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M610,1181.1113 L610,1191.1113 L620,1191.1113 L610,1181.1113 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="363" y="1198.6797">Deactive pending</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="476" y="1198.6797">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="571" y="1198.6797">event</text><polygon fill="#A80036" points="653.5,1232.7324,663.5,1236.7324,653.5,1240.7324,657.5,1236.7324" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="352.5" x2="659.5" y1="1236.7324" y2="1236.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="359.5" y="1231.9902">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="381.5" y="1231.9902">Persist updated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="482.5" y="1231.9902">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="577.5" y="1231.9902">to CEP Store</text><polygon fill="#FFFFE0" filter="url(#f1kh3sl0ungvo9)" points="645,1279.7324,695,1279.7324,705,1290.7324,695,1302.7324,645,1302.7324,635,1290.7324,645,1279.7324" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="647" y="1296.3008">actions</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="243.5" x2="726.5" y1="1316.043" y2="1316.043"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="329" x="248.5" y="1326.6777">[Ignore - Message does not qualify for notification action]</text><!--
@startuml
title 10.2. Notification Limit Adjustment Rules Validation
autonumber

collections "Notification-Topic" as topicNotify
control "Central Event Processor" as CEP
database "CEP Store" as DB

box "Central Services" #LightYellow
participant topicNotify
end box
box "Central Event Processing Service" #LightGreen
participant CEP
participant DB
end box

Group Limit Adjustment Rules Validation
    activate CEP
    note right of topicNotify #LightGrey
        Events are published
        to Notification Topic
        by Central Services
    end note
    topicNotify <- CEP: Consumes notification messages
    activate topicNotify
    deactivate topicNotify
    CEP -> CEP: Filter according to event action
    note right of CEP
        Qualifying event action:

        {
            "limit" in data.value.content.payload
        }
    end note

    alt Messages event type that qualify
        CEP -> DB: Update current **limits**
        activate DB
        hnote over DB #LightYellow
            limits
        end hnote
        deactivate DB
        CEP -> DB: Create **events** per participant
        activate DB
        hnote over DB #LightYellow
            events
        end hnote
        deactivate DB
        CEP -> CEP
        note right of CEP #LightGrey
            Check if there is a difference
            between the stored and captured **limits**
            for both **payee** and **payer**
            for all **currencies**.
        end note

        alt Limit difference identified
            CEP -> CEP
            note right of CEP #LightGrey
                Create new **Action Object**.
            end note
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg 10.4-action-flow]]} \n
        else Limits are equal - same event
            CEP -> CEP
            note right of CEP #LightGrey
                Send Action Object to Action Agent.
            end note
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg 10.4-action-flow]]} \n
            CEP -> DB: Request **Action Object** for event
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
            CEP <- - DB: Return results
            deactivate DB
            note right of CEP #lightGrey
                Deactive pending **Action Object** event
            end note
            CEP -> DB: Persist updated **Action Object** to CEP Store
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
           deactivate DB
        end
    else Ignore - Message does not qualify for notification action
    end
    deactivate CEP
end
@enduml

PlantUML version 1.2018.11(Sat Sep 22 18:43:53 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Mac OS X
OS Version: 10.14.2
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>