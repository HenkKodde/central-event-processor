<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1068.8px" preserveAspectRatio="none" style="width:616px;height:1068px;" version="1.1" viewBox="0 0 616 1068" width="616.8px" zoomAndPan="magnify"><defs><filter height="300%" id="f1xf2srbhe9l4w" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.600000023841858"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="3.200000047683716" dy="3.200000047683716" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="11.2" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="304" x="157.4" y="18.8281">10.2. Notification Limit Adjustment Rules Validation</text><rect fill="#FFFFE0" height="1032.8531" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="124" x="84.8" y="27.5906"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="103.6" y="37.6453">Central Services</text><rect fill="#90EE90" height="1032.8531" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="310.4" x="277.2" y="27.5906"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="176" x="344.4" y="37.6453">Central Event Processing Service</text><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="142.8" y="193.4719"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="893.4235" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="343.6" y="101.0297"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="362.4109"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="436.5078"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="809.2469"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="914.2406"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="887.8235" style="stroke: #000000; stroke-width: 1.600000023841858;" width="598.8" x="9.6" y="106.6297"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="657.3391" style="stroke: #000000; stroke-width: 1.600000023841858;" width="336" x="264.4" y="331.5141"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="370.0906" style="stroke: #000000; stroke-width: 1.600000023841858;" width="320" x="272.4" y="601.1984"/><rect fill="#FFFFFF" height="273.6484" style="stroke: none; stroke-width: 0.800000011920929;" width="320" x="272.4" y="697.6406"/><rect fill="#FFFFFF" height="11.9641" style="stroke: none; stroke-width: 0.800000011920929;" width="336" x="264.4" y="976.8891"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 5.0,5.0;" x1="146.4" x2="146.4" y1="93.0297" y2="1008.0531"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 5.0,5.0;" x1="347.6" x2="347.6" y1="93.0297" y2="1008.0531"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 5.0,5.0;" x1="555.6" x2="555.6" y1="93.0297" y2="1008.0531"/><rect fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="91.2" y="61.4391"/><rect fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="88" y="64.6391"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="100" x="93.6" y="81.0672">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="91.2" y="1007.2531"/><rect fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" height="24.3906" style="stroke: #A80036; stroke-width: 1.2000000178813934;" width="111.2" x="88" y="1010.4531"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="100" x="93.6" y="1026.8813">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="129.6" x="280.4" y="90.6672">Central Event Processor</text><ellipse cx="347.6" cy="67.0391" fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 1.600000023841858;"/><polygon fill="#A80036" points="344.4,57.4391,349.2,53.4391,347.6,57.4391,349.2,61.4391,344.4,57.4391" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="129.6" x="280.4" y="1018.0813">Central Event Processor</text><ellipse cx="347.6" cy="1033.2438" fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 1.600000023841858;"/><polygon fill="#A80036" points="344.4,1023.6438,349.2,1019.6438,347.6,1023.6438,349.2,1027.6438,344.4,1023.6438" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="526.8" y="90.6672">CEP Store</text><path d="M541.2,51.0391 C541.2,43.0391 555.6,43.0391 555.6,43.0391 C555.6,43.0391 570,43.0391 570,51.0391 L570,71.8391 C570,79.8391 555.6,79.8391 555.6,79.8391 C555.6,79.8391 541.2,79.8391 541.2,71.8391 L541.2,51.0391 " fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><path d="M541.2,51.0391 C541.2,59.0391 555.6,59.0391 555.6,59.0391 C555.6,59.0391 570,59.0391 570,51.0391 " fill="none" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><text fill="#000000" font-family="sans-serif" font-size="11.2" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="526.8" y="1018.0813">CEP Store</text><path d="M541.2,1028.4438 C541.2,1020.4438 555.6,1020.4438 555.6,1020.4438 C555.6,1020.4438 570,1020.4438 570,1028.4438 L570,1049.2438 C570,1057.2438 555.6,1057.2438 555.6,1057.2438 C555.6,1057.2438 541.2,1057.2438 541.2,1049.2438 L541.2,1028.4438 " fill="#FEFECE" filter="url(#f1xf2srbhe9l4w)" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><path d="M541.2,1028.4438 C541.2,1036.4438 555.6,1036.4438 555.6,1036.4438 C555.6,1036.4438 570,1036.4438 570,1028.4438 " fill="none" style="stroke: #000000; stroke-width: 1.2000000178813934;"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="142.8" y="193.4719"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="893.4235" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="343.6" y="101.0297"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="362.4109"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="436.5078"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="50.0969" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="809.2469"/><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="24" style="stroke: #A80036; stroke-width: 0.800000011920929;" width="8" x="551.6" y="914.2406"/><path d="M9.6,106.6297 L229.6,106.6297 L229.6,112.2297 L221.6,120.2297 L9.6,120.2297 L9.6,106.6297 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.800000011920929;"/><rect fill="none" height="887.8235" style="stroke: #000000; stroke-width: 1.600000023841858;" width="598.8" x="9.6" y="106.6297"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="184" x="21.6" y="117.4844">Limit Adjustment Rules Validation</text><path d="M17.6,124.4781 L17.6,168.4781 L139.2,168.4781 L139.2,132.4781 L131.2,124.4781 L17.6,124.4781 " fill="#D3D3D3" filter="url(#f1xf2srbhe9l4w)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M131.2,124.4781 L131.2,132.4781 L139.2,132.4781 L131.2,124.4781 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="104" x="22.4" y="138.5328">Events are published</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="104.8" x="22.4" y="150.7813">to Notification Topic</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="98.4" x="22.4" y="163.0297">by Central Services.</text><polygon fill="#A80036" points="159.6,190.2719,151.6,193.4719,159.6,196.6719,156.4,193.4719" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="154.8" x2="342.8" y1="193.4719" y2="193.4719"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="164.4" y="189.6781">1</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="167.2" x="174.8" y="189.6781">Consumes notification messages</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="385.2" y1="240.9203" y2="240.9203"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="385.2" x2="385.2" y1="240.9203" y2="251.3203"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="352.4" x2="385.2" y1="251.3203" y2="251.3203"/><polygon fill="#A80036" points="360.4,248.1203,352.4,251.3203,360.4,254.5203,357.2,251.3203" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="237.1266">2</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="156.8" x="367.6" y="237.1266">Filter according to event action</text><path d="M355.2,261.7203 L355.2,318.5203 L567.2,318.5203 L567.2,269.7203 L559.2,261.7203 L355.2,261.7203 " fill="#FFFF00" filter="url(#f1xf2srbhe9l4w)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M559.2,261.7203 L559.2,269.7203 L567.2,269.7203 L559.2,261.7203 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="120" x="360" y="275.775">Qualifying event action:</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="360" y="288.0234">{</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="182.4" x="372.8" y="300.2719">"limit" in data.value.content.payload</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="360" y="312.5203">}</text><path d="M264.4,331.5141 L314,331.5141 L314,337.1141 L306,345.1141 L264.4,345.1141 L264.4,331.5141 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.800000011920929;"/><rect fill="none" height="657.3391" style="stroke: #000000; stroke-width: 1.600000023841858;" width="336" x="264.4" y="331.5141"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13.6" x="276.4" y="342.3688">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="326" y="341.6219">[Messages event type that qualify]</text><polygon fill="#A80036" points="542,359.2109,550,362.4109,542,365.6109,545.2,362.4109" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="546.8" y1="362.4109" y2="362.4109"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="358.6172">3</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="74.4" x="367.6" y="358.6172">Update current</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29.6" x="445.2" y="358.6172">limits</text><polygon fill="#FFFFE0" filter="url(#f1xf2srbhe9l4w)" points="539.2,396.8109,571.2,396.8109,579.2,405.6109,571.2,415.2109,539.2,415.2109,531.2,405.6109,539.2,396.8109" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="540.8" y="410.0656">limits</text><polygon fill="#A80036" points="542,433.3078,550,436.5078,542,439.7078,545.2,436.5078" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="546.8" y1="436.5078" y2="436.5078"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="432.7141">4</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="32" x="367.6" y="432.7141">Create</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="402.8" y="432.7141">events</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="73.6" x="442" y="432.7141">per participant</text><polygon fill="#FFFFE0" filter="url(#f1xf2srbhe9l4w)" points="537.6,470.9078,573.6,470.9078,581.6,479.7078,573.6,489.3078,537.6,489.3078,529.6,479.7078,537.6,470.9078" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="32.8" x="539.2" y="484.1625">events</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="385.2" y1="510.6047" y2="510.6047"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="385.2" x2="385.2" y1="510.6047" y2="521.0047"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="352.4" x2="385.2" y1="521.0047" y2="521.0047"/><polygon fill="#A80036" points="360.4,517.8047,352.4,521.0047,360.4,524.2047,357.2,521.0047" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="506.8109">5</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="0" x="370.8" y="506.8109"/><path d="M355.2,531.4047 L355.2,588.2047 L569.6,588.2047 L569.6,539.4047 L561.6,531.4047 L355.2,531.4047 " fill="#D3D3D3" filter="url(#f1xf2srbhe9l4w)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M561.6,531.4047 L561.6,539.4047 L569.6,539.4047 L561.6,531.4047 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="144.8" x="360" y="545.4594">Check if there is a difference</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="164.8" x="360" y="557.7078">between the stored and captured</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29.6" x="528" y="557.7078">limits</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="40.8" x="360" y="569.9563">for both</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32.8" x="404" y="569.9563">payee</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="18.4" x="440" y="569.9563">and</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31.2" x="461.6" y="569.9563">payer</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="29.6" x="360" y="582.2047">for all</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56.8" x="392.8" y="582.2047">currencies</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="449.6" y="582.2047">.</text><path d="M272.4,601.1984 L322,601.1984 L322,606.7984 L314,614.7984 L272.4,614.7984 L272.4,601.1984 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.800000011920929;"/><rect fill="none" height="370.0906" style="stroke: #000000; stroke-width: 1.600000023841858;" width="320" x="272.4" y="601.1984"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13.6" x="284.4" y="612.0531">alt</text><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124.8" x="334" y="611.3063">[Limit difference identified]</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="385.2" y1="632.0953" y2="632.0953"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="385.2" x2="385.2" y1="632.0953" y2="642.4953"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="352.4" x2="385.2" y1="642.4953" y2="642.4953"/><polygon fill="#A80036" points="360.4,639.2953,352.4,642.4953,360.4,645.6953,357.2,642.4953" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="628.3016">6</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="55.2" x="367.6" y="628.3016">Create new</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72.8" x="426" y="628.3016">Action Object</text><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="44.7453" style="stroke: #000000; stroke-width: 1.600000023841858;" width="164" x="278" y="648.8953"/><polygon fill="#EEEEEE" points="278,648.8953,329.2,648.8953,329.2,654.4953,321.2,662.4953,278,662.4953,278,648.8953" style="stroke: #000000; stroke-width: 1.600000023841858;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="15.2" x="288.4" y="660.55">ref</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="128.8" x="282.8" y="675.75">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="22.4" x="411.6" y="675.75">10.4</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="411.6" x2="434" y1="677.35" y2="677.35"/></a><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="434" y="675.75">}</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="0" x="286" y="687.9984"/><line style="stroke: #000000; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="272.4" x2="592.4" y1="698.4406" y2="698.4406"/><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140.8" x="276.4" y="706.9484">[Limits are equal - same event]</text><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="385.2" y1="726.6531" y2="726.6531"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="385.2" x2="385.2" y1="726.6531" y2="737.0531"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="352.4" x2="385.2" y1="737.0531" y2="737.0531"/><polygon fill="#A80036" points="360.4,733.8531,352.4,737.0531,360.4,740.2531,357.2,737.0531" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="722.8594">7</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="178.4" x="367.6" y="722.8594">Send Action Object to Action Agent</text><rect fill="#FFFFFF" filter="url(#f1xf2srbhe9l4w)" height="44.7453" style="stroke: #000000; stroke-width: 1.600000023841858;" width="164" x="278" y="743.4531"/><polygon fill="#EEEEEE" points="278,743.4531,329.2,743.4531,329.2,749.0531,321.2,757.0531,278,757.0531,278,743.4531" style="stroke: #000000; stroke-width: 1.600000023841858;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="15.2" x="288.4" y="755.1078">ref</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="128.8" x="282.8" y="770.3078">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="22.4" x="411.6" y="770.3078">10.4</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="411.6" x2="434" y1="771.9078" y2="771.9078"/></a><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="3.2" x="434" y="770.3078">}</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="0" x="286" y="782.5563"/><polygon fill="#A80036" points="542,806.0469,550,809.2469,542,812.4469,545.2,809.2469" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="546.8" y1="809.2469" y2="809.2469"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="357.2" y="805.4531">8</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="40" x="367.6" y="805.4531">Request</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72.8" x="410.8" y="805.4531">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="44.8" x="486.8" y="805.4531">for event</text><polygon fill="#FFFFE0" filter="url(#f1xf2srbhe9l4w)" points="535.2,819.6469,575.2,819.6469,583.2,828.4469,575.2,838.0469,535.2,838.0469,527.2,828.4469,535.2,819.6469" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="36.8" x="536.8" y="832.9016">actions</text><polygon fill="#A80036" points="360.4,856.1438,352.4,859.3438,360.4,862.5438,357.2,859.3438" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="355.6" x2="554.8" y1="859.3438" y2="859.3438"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="365.2" y="855.55">9</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="70.4" x="375.6" y="855.55">Return results</text><path d="M355.2,869.7438 L355.2,889.7438 L568.8,889.7438 L568.8,877.7438 L560.8,869.7438 L355.2,869.7438 " fill="#D3D3D3" filter="url(#f1xf2srbhe9l4w)" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><path d="M560.8,869.7438 L560.8,877.7438 L568.8,877.7438 L560.8,869.7438 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="87.2" x="360" y="883.7985">Deactive pending</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72.8" x="450.4" y="883.7985">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="30.4" x="526.4" y="883.7985">event.</text><polygon fill="#A80036" points="542,911.0406,550,914.2406,542,917.4406,545.2,914.2406" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><line style="stroke: #A80036; stroke-width: 0.800000011920929;" x1="351.6" x2="546.8" y1="914.2406" y2="914.2406"/><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14.4" x="357.2" y="910.4469">10</text><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="77.6" x="374.8" y="910.4469">Persist updated</text><text fill="#000000" font-family="sans-serif" font-size="10.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72.8" x="455.6" y="910.4469">Action Object</text><polygon fill="#FFFFE0" filter="url(#f1xf2srbhe9l4w)" points="535.2,948.6406,575.2,948.6406,583.2,957.4406,575.2,967.0406,535.2,967.0406,527.2,957.4406,535.2,948.6406" style="stroke: #A80036; stroke-width: 0.800000011920929;"/><text fill="#000000" font-family="sans-serif" font-size="10.4" lengthAdjust="spacingAndGlyphs" textLength="36.8" x="536.8" y="961.8953">actions</text><line style="stroke: #000000; stroke-width: 0.800000011920929; stroke-dasharray: 2.0,2.0;" x1="264.4" x2="600.4" y1="977.6891" y2="977.6891"/><text fill="#000000" font-family="sans-serif" font-size="8.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="263.2" x="268.4" y="986.1969">[Ignore - Message does not qualify for notification action]</text><!--
@startuml
title 10.2. Notification Limit Adjustment Rules Validation
autonumber

collections "Notification-Topic" as topicNotify
control "Central Event Processor" as CEP
database "CEP Store" as DB

box "Central Services" #LightYellow
participant topicNotify
end box
box "Central Event Processing Service" #LightGreen
participant CEP
participant DB
end box

Group Limit Adjustment Rules Validation
    activate CEP
    note left of topicNotify #LightGrey
        Events are published
        to Notification Topic
        by Central Services.
    end note
    topicNotify <- CEP: Consumes notification messages
    activate topicNotify
    deactivate topicNotify
    CEP -> CEP: Filter according to event action
    note right of CEP #yellow
        Qualifying event action:
        {
            "limit" in data.value.content.payload
        }
    end note

    alt Messages event type that qualify
        CEP -> DB: Update current **limits**
        activate DB
        hnote over DB #LightYellow
            limits
        end hnote
        deactivate DB
        CEP -> DB: Create **events** per participant
        activate DB
        hnote over DB #LightYellow
            events
        end hnote
        deactivate DB
        CEP -> CEP
        note right of CEP #LightGrey
            Check if there is a difference
            between the stored and captured **limits**
            for both **payee** and **payer**
            for all **currencies**.
        end note

        alt Limit difference identified
            CEP -> CEP: Create new **Action Object**
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg 10.4]]} \n
        else Limits are equal - same event
            CEP -> CEP: Send Action Object to Action Agent
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/tree/master/docs/sequence_diagrams/seq-cep-10.4-action-flow.svg 10.4]]} \n
            CEP -> DB: Request **Action Object** for event
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
            CEP <- - DB: Return results
            deactivate DB
            note right of CEP #lightGrey
                Deactive pending **Action Object** event.
            end note
            CEP -> DB: Persist updated **Action Object**
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
           deactivate DB
        end
    else Ignore - Message does not qualify for notification action
    end
    deactivate CEP
end
@enduml

PlantUML version 1.2018.11(Sat Sep 22 18:43:53 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Mac OS X
OS Version: 10.14.2
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>